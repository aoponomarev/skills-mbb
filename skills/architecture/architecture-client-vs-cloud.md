---
title: architecture-client-vs-cloud
tags:
  - "#mbb-spec"
  - "#architecture"
dependencies: []
mcp_resource: true
updated_at: 2026-01-24
---
## Scope

- Architecture Client Vs Cloud functionality and configuration.

## When to Use

- При необходимости работы с данным компонентом или функционалом.



# architecture-client-vs-cloud

> Источник: `docs/doc-architect.md` (раздел "Разделение ответственности: клиент vs облако")

## Принцип привязки к версии приложения

**КРИТИЧЕСКИ ВАЖНО:** Функциональность, привязанная к версии приложения, должна оставаться на клиенте. **Обоснование:** Это гарантирует соответствие между кодом и конфигурацией, предотвращает рассинхронизацию при обновлениях, упрощает развертывание (статический фронтенд), обеспечивает детерминированное поведение каждой версии. Пользовательские данные хранятся в облаке независимо от версии.

## Клиентская ответственность (локализация на клиенте)

**Что хранится в коде приложения:**
- **Конфигурация приложения** — API endpoints, лимиты, таймауты, feature flags (`core/config/app-config.js`)
- **UI компоненты** — Vue-компоненты, шаблоны, стили
- **Бизнес-логика** — валидация, расчеты, обработка данных
- **Системные сообщения** — тексты ошибок и предупреждений (`core/config/messages-config.js`)
- **Конфигурация модальных окон** — заголовки, иконки, метаданные (`core/config/modals-config.js`)
- **Конфигурация кэширования** — TTL, стратегии, версии схем (`core/cache/cache-config.js`)
- **Библиотеки** — Vue.js, Bootstrap, прочие зависимости
- **Переводы (кэш)** — кэш переводов системных сообщений (привязан к версии приложения)

## Облачная ответственность (хранение в облаке)

**Cloudflare D1 (структурированные пользовательские данные):**
- Пользовательские аккаунты, профили (`users`)
- Портфели пользователя (`portfolios`)
- Пользовательские настройки (`user_settings`)
- История операций/ребалансировок (перспектива)

**Cloudflare R2 (объектное хранилище, перспектива):**
- Пользовательские математические модели (JSON/файлы моделей)
- Datasets и рыночные временные ряды
- Статистика портфелей и отчеты
- История расчетов, бэкапы

## Примеры разделения

- Системные сообщения → клиент (привязаны к версии)
- Конфигурация API → клиент (часть логики приложения)
- Портфели пользователя → облако (D1)
- Настройки пользователя → облако (D1)
- Математические модели пользователя → облако (R2)
- Статистика портфелей → облако (R2)
- Кэш переводов → клиент (версионируется по версии приложения)
